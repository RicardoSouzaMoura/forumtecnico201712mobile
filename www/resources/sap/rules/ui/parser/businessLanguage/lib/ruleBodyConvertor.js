jQuery.sap.declare("sap.rules.ui.parser.ruleBody.lib.ruleBodyConvertor");jQuery.sap.require("sap.rules.ui.parser.ruleBody.lib.ruleBodyValidator");var ruleBodyValidatorLib=sap.rules.ui.parser.ruleBody.lib.ruleBodyValidator.lib;jQuery.sap.require("sap.rules.ui.parser.ruleBody.lib.constants");var constants=sap.rules.ui.parser.ruleBody.lib.constants.lib;sap.rules.ui.parser.ruleBody.lib.ruleBodyConvertor=sap.rules.ui.parser.ruleBody.lib.ruleBodyConvertor||{};sap.rules.ui.parser.ruleBody.lib.ruleBodyConvertor.lib=(function(){function R(){jQuery.sap.log.debug("CTOR - Rule Convertor");ruleBodyValidatorLib.RuleBodyValidator.call(this);this.convertedRuleBody=null;}R.prototype=Object.create(ruleBodyValidatorLib.RuleBodyValidator.prototype);R.prototype.constructor=R;R.prototype.isParserConvertedExpression=function isParserConvertedExpression(){if(this.status===constants.RULE_SUCCESS){if(!this.currentParserResult.hasOwnProperty(constants.parserResultEnum.convertedExpression)){this.status=constants.RULE_ERROR;}else{return true;}}return false;};R.prototype.getParserConvertedExpression=function getParserConvertedExpression(){return this.currentParserResult[constants.parserResultEnum.convertedExpression];};R.prototype.handleTextCondition=function handleTextCondition(c,r,p){ruleBodyValidatorLib.RuleBodyValidator.prototype.handleTextCondition.call(this,c,r,p);if(this.isParserConvertedExpression()){this.convertedRuleBody.content.condition=this.getParserConvertedExpression();}};R.prototype.handleTextOutputParameter=function handleTextOutputParameter(c,r,p){ruleBodyValidatorLib.RuleBodyValidator.prototype.handleTextOutputParameter.call(this,c,r,p);if(this.isParserConvertedExpression()){c.content=this.getParserConvertedExpression();}};R.prototype.handleTextActionParameter=function handleTextActionParameter(c,r,i,p){ruleBodyValidatorLib.RuleBodyValidator.prototype.handleTextActionParameter.call(this,c,r,i,p);if(this.isParserConvertedExpression()){c.content=this.getParserConvertedExpression();}};R.prototype.handleDecisionTableCondition=function handleDecisionTableCondition(h,c,a,r){var b;r=ruleBodyValidatorLib.RuleBodyValidator.prototype.handleDecisionTableCondition.call(this,h,c,a,r);if(this.isParserConvertedExpression()){b=this.getParserConvertedExpression();c.row[a].content=this.splitDecisionTableCondition(h.convertedExpression,b);h.expression=h.convertedExpression;}return r;};R.prototype.handleDecisionTableActionParameter=function handleDecisionTableActionParameter(h,c,a,r){r=ruleBodyValidatorLib.RuleBodyValidator.prototype.handleDecisionTableActionParameter.call(this,h,c,a,r);if(this.isParserConvertedExpression()){c.row[a].content=this.getParserConvertedExpression();}return r;};R.prototype.handleDecisionTableOutputParameter=function handleDecisionTableOutputParameter(h,c,a,r){r=ruleBodyValidatorLib.RuleBodyValidator.prototype.handleDecisionTableOutputParameter.call(this,h,c,a,r);if(this.isParserConvertedExpression()){c.row[a].content=this.getParserConvertedExpression();}return r;};R.prototype.handleConditionHeader=function handleConditionHeader(h){ruleBodyValidatorLib.RuleBodyValidator.prototype.handleConditionHeader.call(this,h);if(this.isParserConvertedExpression()){h.convertedExpression=this.getParserConvertedExpression();}};R.prototype.finalizeResult=function finalizeResult(r){var i;for(i=0;i<r.content.headers.length;i++){if(r.content.headers[i].hasOwnProperty(constants.parserResultEnum.convertedExpression)){delete r.content.headers[i].convertedExpression;}}};R.prototype.initFlags=function initFlags(f){ruleBodyValidatorLib.RuleBodyValidator.prototype.initFlags.call(this,f);if(f!==null&&f!==undefined){if(f.hasOwnProperty(constants.outputFlagsEnum.conversionOutput)){this.flags[constants.outputFlagsEnum.conversionOutput]=f[constants.outputFlagsEnum.conversionOutput];}}};R.prototype.convert=function convert(r,v,a,f,o,p,t){this.convertedRuleBody=JSON.parse(JSON.stringify(r));var b=this.validateBusinessRule(this.convertedRuleBody,v,a,f,o,p,t);if(this.status===constants.RULE_SUCCESS){b.convertedRuleBody=this.convertedRuleBody;}else{b.convertedRuleBody=null;}return b;};return{RuleBodyConvertor:R};}());
