sap.ui.define(["sap/ui/core/ValueState","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox"],function(V,F,a,M,b){"use strict";var h={badRequest:"400",forbidden:"403",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500"};var o={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity"};function s(P,C){b.show(P.message,{icon:P.messageBoxIcon||b.Icon.ERROR,title:P.title||sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_TITLE"),actions:[b.Action.OK],styleClass:C});}function S(P,n){n.navigateToMessagePage({entitySet:P.entitySet,title:P.title,text:P.message});}function g(R){var t=[],m;var j=sap.ui.getCore().getMessageManager();var k=j.getMessageModel().getData();for(var i=0;i<k.length;i++){m=k[i];if(m.getPersistent()){t.push(m);}}jQuery.noop(R);return t;}function c(P,C){var D;D=function(n,i){var j;var k={onMessageDialogClose:function(){i.onMessageDialogClose();j.destroy();}};j=sap.ui.xmlfragment(n,k);if(C){jQuery.sap.syncStyleClass(C,P,j);}P.addDependent(P);return j;};return D;}function d(m){var j,t,l;var D;var k={onMessageDialogClose:function(){D.close();r();}};if(typeof m=="function"){D=m("sap.ui.generic.app.fragments.MessageDialog",k);}else if(typeof m=="object"){D=c(m.owner,m.contentDensityClass)("sap.ui.generic.app.fragments.MessageDialog",k);}else{return;}D.setModel(sap.ui.getCore().getMessageManager().getMessageModel(),"message");var n=new sap.ui.model.json.JSONModel();D.setModel(n,"settings");var q=D.getContent()[0];l=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");n.setProperty("/closeButtonText",l.getText("DIALOG_CLOSE"));var B=q.getBinding("items");B.filter(new F("persistent",a.EQ,true));var C=B.getContexts();if(C.length===1&&C[0].getObject().type===V.Success){M.show(C[0].getObject().message,{onClose:r});}else if(C.length>0){for(var i=0;i<C.length;i++){var u=C[i].getObject();if(u.type===sap.ui.core.MessageType.Error){j=sap.ui.core.ValueState.Error;break;}if(u.type===sap.ui.core.MessageType.Warning){j=sap.ui.core.ValueState.Warning;continue;}if(u.type===sap.ui.core.MessageType.Information||u.type===sap.ui.core.MessageType.None){j=sap.ui.core.ValueState.None;continue;}j=sap.ui.core.ValueState.Success;}switch(j){case sap.ui.core.ValueState.Error:t=l.getText("ERROR_TITLE");break;case sap.ui.core.ValueState.Warning:t=l.getText("WARNING_TITLE");break;case sap.ui.core.ValueState.Success:t=l.getText("SUCCESS_TITLE");break;default:t=l.getText("INFORMATION_TITLE");break;}if(C.length>1){n.setProperty("/multiMessages",true);}else{n.setProperty("/multiMessages",false);}n.setProperty("/state",j);n.setProperty("/title",t);D.open();}}function r(){var m=sap.ui.getCore().getMessageManager();var t=g();if(t.length>0){m.removeMessages(t);}}function e(m,D,i){var t=new sap.ui.core.message.Message({message:m,description:D,type:sap.ui.core.MessageType.Error,processor:i,target:'',persistent:true});sap.ui.getCore().getMessageManager().addMessages(t);}function f(P,C,n){P=P||{};var E=P.errorContext||{lastOperation:{name:""}};var i=P.response;var m=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var H;if(i instanceof Error){if(i.message){m=i.message;}}else if(i.response){if(i.response.message){m=i.response.message;}if(i.response.statusCode){H=i.response.statusCode;}if(i.response.headers){for(var j in i.response.headers){if(j.toLowerCase()==="content-type"){var k=i.response.headers[j];if(k.toLowerCase().indexOf("application/json")===0){if(i.response.responseText){var O=JSON.parse(i.response.responseText);if(O&&O.error&&O.error.message&&O.error.message.value){m=O.error.message.value;}}}else{if(i.message){m=i.message;}}break;}}}}var l=true;switch(E.lastOperation.name){case"":break;case o.callAction:break;case o.addEntry:l=false;break;case o.modifyEntity:if(h.preconditionFailed==H){l=false;}break;case o.saveEntity:l=!E.isDraft;break;case o.deleteEntity:break;case o.editEntity:break;case o.activateDraftEntity:break;default:break;}var q={entitySet:E.entitySet,title:P.title,message:m};if(l){if(E.showMessages){s(q,C);}}else{S(q,n);}}function p(E){var R;var m=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var H;if(E instanceof Error){if(E.message){m=E.message;}}else if(E.response){if(E.response.message){m=E.response.message;}if(E.response.statusCode){H=E.response.statusCode;}if(E.response.headers){for(var i in E.response.headers){if(i.toLowerCase()==="content-type"){var j=E.response.headers[i];if(j.toLowerCase().indexOf("application/json")===0){if(E.response.responseText){var O=JSON.parse(E.response.responseText);if(O&&O.error&&O.error.message&&O.error.message.value){m=O.error.message.value;}}}else{if(E.message){m=E.message;}}break;}}}}var t=g(E);R={httpStatusCode:H,messageText:m,description:null,containsTransientMessage:(t.length===0)?false:true};return R;}return{operations:o,handleTransientMessages:d,removeTransientMessages:r,addTransientErrorMessage:e,handleError:f,parseErrorResponse:p};},true);
